<script src="../../../../Scripts/Common/jatoolsPrinter.js"></script>
<script src="../../../../Scripts/Common/Framework/jquery-1.7.1.min.js"></script>
<script src="../../../../Scripts/WMS/OrderManagement/PrintOrder_JT.js"></script>
<script src="../../../../Scripts/Common/jquery-barcode.js"></script>
@model Runbow.TWS.Web.Areas.WMS.Models.OrderManagement.OrderViewModel
@Url.jsrender()
@Url.Json2()
@Html.Hidden("IDs", (string)ViewBag.IDs)
@{
    Layout = null;
}
<style media="print">
    .bcTarget {
        font-size: 25px;
    }

    .Noprint {
        display: none;
    }

    .PageNext {
        page-break-after: always;
    }

    .atr {
        border-bottom: 1px #ccc solid;
    }
</style>
<script type="text/javascript">

    function printWithAlert() {

        UpdatePrintStatus();
        document.all.WebBrowser.ExecWB(6, 1);
        //  window.WebBrowser.ExecWB(45, 1);
    }
    function printWithoutAlert() {
        document.all.WebBrowser.ExecWB(6, 6);
    }
    function printSetup() {
        document.all.WebBrowser.ExecWB(8, 1);
    }
    function printPrieview() {
    }
    function printImmediately() {
        document.all.WebBrowser.ExecWB(6, 6);
        window.close();
    }
    function printReturn() {
        // post('/POD/POD/QueryPod', { QueryPodViewModel: null, Action: '查询' });
        window.location.href = '/WMS/OrderManagement/Index';
    }
    function post(URL, PARAMS) {
        var temp = document.createElement("form");
        temp.action = URL;
        temp.method = "post";
        temp.style.display = "none";
        for (var x in PARAMS) {
            var opt = document.createElement("textarea");
            opt.name = x;
            opt.value = PARAMS[x];
            // alert(opt.name)
            temp.appendChild(opt);
        }
        document.body.appendChild(temp);
        temp.submit();
        return temp;
    }
   
    //$(function () {
    //    $.each($(".bcTarget"), function (a, b) {
    //        BarcodeC(b, $(b).html());
    //    });
    //})
    //更新打印次数
    function UpdatePrintStatus() {
        var ids = "";
        ids = $("#IDs").val();
        $.ajax({
            type: "POST",
            url: "/WMS/OrderManagement/UpdatePrintStatus",
            data: {
                "IDs": ids,
            },
            async: "false",
            success: function (data) {

            },
            error: function (msg) {
                alert(msg.val);
            }
        });
    }
</script>
<object id="WebBrowser" classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2" style="display: none"></object>
<table align="center" class="NOPRINT">
    <tr>
        <td align="center">
            <button title="打印" onclick="printWithAlert()">打印</button>
            @*<button onclick='printPrieview()' title='打印预览...'>打印预览</button>*@
            <input type="button" value="打印设置" onclick="printSetup()">
            <button title="返回" onclick="printReturn()">返回</button>
        </td>
        @*<button title="直接打印" onclick="printWithoutAlert()">直接打印</button>*@
    </tr>
</table>
<div class="Noprint">
    以下为打印区:<br>
</div>
@{
    var ctype = (IEnumerable<Runbow.TWS.Entity.WMS.WMS_Config_Type>)ViewBag.ctype;
}
@if (Model.OrderCollection != null && Model.OrderCollection.Any())
{
    var CurrentPage = 0;//当前打印到第几单
    foreach (var item in Model.OrderCollection)
    {
        var ss = 0;
        var ID = "";
        var number = 0;
        decimal counttotal = 0;
        var counts = Model.OrderDetailCollection.Where(c => c.OID == item.ID).Count();
        //行数小于30 1页
        if (counts <= 25)
        {
            //单数大于1
            if (Model.OrderCollection.Count() > 1)
            {
                CurrentPage = CurrentPage + 1;
                //当前打印到第几单和总单数对比
                if (CurrentPage == Model.OrderCollection.Count())
                {
                    <div class="" style="width: 99%; height: 100%;">

                        <div style="width: 100%; height: 100%;">

                            <table style="width: 100%;">
                                <tr>
                                    <td style="width: 40%; font-weight: bolder; font-size: 30px; vertical-align: bottom; text-align: center;">
                                        <span style="margin-left: 40px;">拣货单</span>
                                    </td>
                                </tr>
                            </table>
                            <hr size="1" noshadow color="black" style="border: none; border-top: 2px solid #000;" />
                            <table style="width: 100%; text-align: left;">
                                <tr>
                                    <td colspan="2" style="font-weight: bold; font-size: 16px;">
                                        订单信息
                                    </td>
                                    <td></td>
                                </tr>
                                <tr style="height: 20px;">
                                    <td style="text-align: left;" colspan="1">
                                        <div class="bcTarget">@item.OrderNumber.ToString()</div>
                                    </td>
                                    <td style="text-align: left;" colspan="2">
                                        <div class="bcTarget">@item.ExternOrderNumber.ToString()</div>
                                    </td>
                                </tr>
                                <tr style="height: 20px;">
                                    <td style="font-weight: bold; font-size: 14px;">
                                        出库单号：<strong style="border-bottom: 1px solid #000;">@item.OrderNumber</strong>
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        外部单号：<strong style="border-bottom: 1px solid #000;">@item.ExternOrderNumber</strong>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        预出库单号：<strong style="border-bottom: 1px solid #000;">@item.PreOrderNumber</strong>
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        出库日期：<strong style="border-bottom: 1px solid #000;">@item.OrderTime</strong>
                                    </td>

                                </tr>
                                <tr>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        客户姓名：<strong style="border-bottom: 1px solid #000;">@item.Consignee</strong>
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        联系方式：<strong style="border-bottom: 1px solid #000;">@item.Contact</strong>
                                    </td>
                                </tr>
                                @*<tr>
                                    <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                        补货类型：<strong style="border-bottom: 1px solid #000;">@item.str8</strong>
                                    </td>
                                    <td style="font-weight:bold;font-size:14px;">
                                        PLNO：<strong style="border-bottom:1px solid #000;">@item.str9</strong>
                                    </td>
                                </tr>*@
                                <tr>
                                    <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                        收货地址：<strong style="border-bottom: 1px solid #000;">@item.Address</strong>
                                    </td>
                                </tr>
                            </table>
                            <table border="1" cellspacing="0" cellpadding="0" style="width: 100%; margin-top: 5px; border-collapse: collapse;">
                                <tr>
                                    <td style="font-weight: bold; font-size: 16px;  text-align: left;" colspan="7">
                                        拣货明细&nbsp;&nbsp;@item.ExternOrderNumber
                                    </td>
                                </tr>
                                <tr style="height: 23px;">
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        行号
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        库区
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        库位
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        SKU
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        产品名称
                                    </td>
                                    @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        Size
                                    </td>
                                    <td style="width:15px; font-weight: bold; font-size: 14px; text-align: center;">
                                        BU
                                    </td>*@
                                    <td style="word-break : break-all;width:35px; font-weight: bold; font-size: 14px; text-align: center;">
                                        建议数量
                                    </td>
                                    <td style="white-space: nowrap;width:35px;font-weight: bold; font-size: 14px; text-align: center;">
                                        实捡数量
                                    </td>
                                    @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        Gender
                                    </td>
                                    <td style="word-break : break-all; width:32px;font-weight: bold; font-size: 14px; text-align: center;">
                                        Retail Price
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        MSRP
                                    </td>
                                    <td style="word-break : break-all; width:25px;font-weight: bold; font-size: 14px; text-align: center;">
                                        安全扣
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        衣架
                                    </td>*@
                                </tr>

                                @if (Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any() != null && Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any())
                                {
                                    foreach (var items in Model.OrderDetailCollection.Where(c => c.OID == item.ID))
                                    {
                                        counttotal += (decimal)items.Qty;
                                        number++;
                                        if (items.OID == item.ID)
                                        {
                                            <tr style="height: 30px;">
                                                <td style="text-align: center; font-size: 14px;">@number</td>
                                                <td style="text-align: center; font-size: 14px;">@items.Area</td>
                                                <td style="text-align: center; font-size: 14px;">@items.Location</td>
                                                <td style="text-align: center; font-size: 14px;">@items.SKU</td>
                                                <td style="text-align: center; font-size: 14px;width:300px;">@items.GoodsName</td>
                                                @*<td style="text-align: center; font-size: 14px;">@items.Size</td>
                                                <td style="text-align: center; font-size: 14px;">@items.BU</td>*@
                                                <td style="text-align: center; font-size: 14px;width:70px;">@items.Qty.ToString().Substring(0, @items.Qty.ToString().Length - 3)</td>
                                                <td style="text-align: center; font-size: 14px;width:70px;">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                @*<td style="text-align: center; font-size: 14px;">@items.Gender</td>
                                                <td style="text-align: center; font-size: 14px;">@items.Price</td>
                                                <td style="text-align:center;font-size:14px;">@items.MSRP</td>
                                                <td style="text-align: center; font-size: 14px;">@items.SafeLock</td>
                                                <td style="text-align: center; font-size: 14px;">@items.Hanger</td>*@
                                            </tr>
                                        }
                                    }
                                    <tr>
                                        <td style="border-right:none;border-bottom:none;" colspan="3"> </td>
                                        <td style="text-align: center; font-size: 14px;border-left:none;border-bottom:none;" colspan="2">总计 : @counttotal.ToString().Substring(0, @counttotal.ToString().Length - 3)</td>
                                        <td style="border-bottom:none" colspan="2"> </td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: left; font-size: 14px;border-right:none;border-top:none;" colspan="3">捡货人：</td>
                                        <td style="text-align: left; font-size: 14px;border-left:none;border-top:none;" colspan="2">捡货时间:</td>
                                        <td style="text-align: right;border-top:none;" colspan="2"> 1 / 1 页</td>
                                    </tr>
                                }
                            </table>
                        </div>
                    </div>
                }
                else
                {
                    <div class="PageNext" style="width: 99%; height: 100%;border:1px solid red">
                        <div style="width: 100%; height: 100%;">
                            <table style="width: 100%;">
                                <tr>
                                    <td style="width: 40%; font-weight: bolder; font-size: 30px; vertical-align: bottom; text-align: center;">
                                        <span style="margin-left: 40px;">拣货单</span>
                                    </td>
                                </tr>
                            </table>
                            <hr size="1" noshadow color="black" style="border: none; border-top: 2px solid #000;" />
                            <table style="width: 100%; text-align: left;">
                                <tr>
                                    <td colspan="2" style="font-weight: bold; font-size: 16px;">
                                        订单信息
                                    </td>
                                    <td></td>
                                </tr>
                                <tr style="height: 20px;">
                                    <td style="text-align: left;" colspan="1">
                                        <div class="bcTarget">@item.OrderNumber.ToString()</div>
                                    </td>
                                    <td style="text-align: left;" colspan="2">
                                        <div class="bcTarget">@item.ExternOrderNumber.ToString()</div>
                                    </td>
                                </tr>
                                <tr style="height: 20px;">
                                    <td style="font-weight: bold; font-size: 14px;">
                                        出库单号：<strong style="border-bottom: 1px solid #000;">@item.OrderNumber</strong>
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        外部单号：<strong style="border-bottom: 1px solid #000;">@item.ExternOrderNumber</strong>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        预出库单号：<strong style="border-bottom: 1px solid #000;">@item.PreOrderNumber</strong>
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        出库日期：<strong style="border-bottom: 1px solid #000;">@item.OrderTime</strong>
                                    </td>

                                </tr>
                                <tr>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        客户姓名：<strong style="border-bottom: 1px solid #000;">@item.Consignee</strong>
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px;">
                                        联系方式：<strong style="border-bottom: 1px solid #000;">@item.Contact</strong>
                                    </td>
                                </tr>
                                @*<tr>
                                    <td style="font-weight: bold; font-size: 14px;"colspan="2">
                                        补货类型：<strong style="border-bottom: 1px solid #000;">@item.str8</strong>
                                    </td>
                                    <td style="font-weight:bold;font-size:14px;">
                                        PLNO：<strong style="border-bottom:1px solid #000;">@item.str9</strong>
                                    </td>
                                </tr>*@
                                <tr>
                                    <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                        收货地址：<strong style="border-bottom: 1px solid #000;">@item.Address</strong>
                                    </td>
                                </tr>
                            </table>
                            <table border="1" cellspacing="0" cellpadding="0" style="width: 100%; margin-top: 5px; border-collapse: collapse;">
                                <tr>
                                    <td style="font-weight: bold; font-size: 16px; text-align: left;" colspan="7">
                                        拣货明细&nbsp;&nbsp;@item.ExternOrderNumber
                                    </td>
                                </tr>
                                <tr style="height: 23px;">
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        行号
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        库区
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        库位
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        SKU
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        产品名称
                                    </td>
                                    @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        Size
                                    </td>
                                    <td style="width:15px; font-weight: bold; font-size: 14px; text-align: center;">
                                        BU
                                    </td>*@
                                    <td style="word-break : break-all;width:35px;font-weight: bold; font-size: 14px; text-align: center;">
                                        建议数量
                                    </td>
                                    <td style="white-space: nowrap;width:35px;font-weight: bold; font-size: 14px; text-align: center;">
                                        实捡数量
                                    </td>
                                    @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        Gender
                                    </td>
                                    <td style="word-break : break-all; width:32px;font-weight: bold; font-size: 14px; text-align: center;">
                                        Retail Price
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        MSRP
                                    </td>
                                    <td style="word-break : break-all; width:25px;font-weight: bold; font-size: 14px; text-align: center;">
                                        安全扣
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        衣架
                                    </td>*@
                                </tr>

                                @if (Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any() != null && Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any())
                                {
                                    foreach (var items in Model.OrderDetailCollection.Where(c => c.OID == item.ID))
                                    {
                                        counttotal += (decimal)items.Qty;
                                        number++;
                                        if (items.OID == item.ID)
                                        {
                                            <tr style="height: 30px;">
                                                <td style="text-align: center; font-size: 14px;">@number</td>
                                                <td style="text-align: center; font-size: 14px;">@items.Area</td>
                                                <td style="text-align: center; font-size: 14px;">@items.Location</td>
                                                <td style="text-align: center; font-size: 14px;">@items.SKU</td>
                                                <td style="text-align: center; font-size: 14px;width:300px;">@items.GoodsName</td>
                                                @*<td style="text-align: center; font-size: 14px;">@items.Size</td>
                                                <td style="text-align: center; font-size: 14px;">@items.BU</td>*@
                                                <td style="text-align: center; font-size: 14px;width:70px;">@items.Qty.ToString().Substring(0, @items.Qty.ToString().Length - 3)</td>
                                                <td style="text-align: center; font-size: 14px;width:70px;">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                @*<td style="text-align: center; font-size: 14px;">@items.Gender</td>
                                                <td style="text-align: center; font-size: 14px;">@items.Price</td>
                                                <td style="text-align:center;font-size:14px;">@items.MSRP</td>
                                                <td style="text-align: center; font-size: 14px;">@items.SafeLock</td>
                                                <td style="text-align: center; font-size: 14px;">@items.Hanger</td>*@
                                            </tr>
                                        }
                                    }
                                    <tr>
                                        <td style="border-right:none;border-bottom:none;" colspan="3"> </td>
                                        <td style="text-align: center; font-size: 14px;border-left:none;border-bottom:none;" colspan="2">总计 :@counttotal.ToString().Substring(0, @counttotal.ToString().Length - 3)</td>
                                        <td style="border-bottom:none" colspan="2"> </td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: left; font-size: 14px;border-right:none;border-top:none;" colspan="3">捡货人：</td>
                                        <td style="text-align: left; font-size: 14px;border-left:none;border-top:none;" colspan="2">捡货时间:</td>
                                        <td style="text-align: right;border-top:none;" colspan="2"> 1 / 1 页</td>
                                    </tr>
                                }
                            </table>
                        </div>
                    </div>
                }
            }
            else
            {
                //是它
                <div class="" style="width: 99%; height: 100%;border:1px solid red">
                    <div style="width: 100%; height: 100%;">
                        <table style="width: 100%;">
                            <tr>
                                <td style="width: 40%; font-weight: bolder; font-size: 30px; vertical-align: bottom; text-align: center;">
                                    <span style="margin-left: 40px;">拣货单</span>
                                </td>
                            </tr>
                        </table>

                        <hr size="1" noshadow color="black" style="border: none; border-top: 2px solid #000;" />

                        <table style="width: 100%; text-align: left;">
                            <tr>
                                <td colspan="2" style="font-weight: bold; font-size: 16px;">
                                    订单信息
                                </td>
                                <td></td>
                            </tr>
                            <tr style="height: 20px;">
                                <td style="text-align: left;" colspan="1">
                                    <div class="bcTarget">@item.OrderNumber.ToString()</div>
                                </td>
                                <td style="text-align: left;" colspan="2">
                                    <div class="bcTarget">@item.ExternOrderNumber.ToString()</div>
                                </td>
                            </tr>
                            <tr style="height: 20px;">
                                <td style="font-weight: bold; font-size: 14px;">
                                    出库单号：<strong style="border-bottom: 1px solid #000;">@item.OrderNumber</strong>
                                </td>

                                <td style="font-weight: bold; font-size: 14px;">
                                    外部单号：<strong style="border-bottom: 1px solid #000;">@item.ExternOrderNumber</strong>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold; font-size: 14px;">
                                    预出库单号：<strong style="border-bottom: 1px solid #000;">@item.PreOrderNumber</strong>
                                </td>
                                <td style="font-weight: bold; font-size: 14px;">
                                    出库日期：<strong style="border-bottom: 1px solid #000;">@item.OrderTime</strong>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold; font-size: 14px;">
                                    客户姓名：<strong style="border-bottom: 1px solid #000;">@item.Consignee</strong>
                                </td>
                                <td style="font-weight: bold; font-size: 14px;">
                                    联系方式：<strong style="border-bottom: 1px solid #000;">@item.Contact</strong>
                                </td>
                            </tr>
                            @*<tr>
                                <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                    补货类型：<strong style="border-bottom: 1px solid #000;">@item.str8</strong>
                                </td>
                                <td style="font-weight:bold;font-size:14px;">
                                    PLNO：<strong style="border-bottom:1px solid #000;">@item.str9</strong>
                                </td>
                            </tr>*@
                            <tr>

                                <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                    收货地址：<strong style="border-bottom: 1px solid #000;">@item.Address</strong>
                                </td>
                            </tr>
                        </table>
                        <table border="1" cellspacing="0" cellpadding="0" style="width: 100%; margin-top: 5px; border-collapse: collapse;">
                            <tr>
                                <td style="font-weight: bold; font-size: 16px; text-align: left;" colspan="7">
                                    拣货明细&nbsp;&nbsp;@item.ExternOrderNumber
                                </td>
                            </tr>
                            <tr style="height: 23px;">
                                <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    行号
                                </td>
                                <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    库区
                                </td>
                                <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    库位
                                </td>
                                <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    SKU
                                </td>
                                <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    产品名称
                                </td>
                                @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    Size
                                </td>
                                <td style="width:15px; font-weight: bold; font-size: 14px; text-align: center;">
                                    BU
                                </td>*@
                                @*word-break : break-all;自动换行*@
                                <td style="word-break : break-all;width:35px;font-weight: bold; font-size: 14px; text-align: center;">
                                    建议数量
                                </td>
                                @*white-space: nowrap;不换行 *@
                                <td style="white-space: nowrap; width:35px;font-weight: bold; font-size: 14px; text-align: center;">
                                    实捡数量
                                </td>
                                @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    Gender
                                </td>
                                <td style="word-break : break-all; width:32px; font-weight: bold; font-size: 14px; text-align: center;">
                                    Retail Price
                                </td>
                                <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    MSRP
                                </td>
                                <td style="word-break : break-all; width:25px; font-weight: bold; font-size: 14px; text-align: center;">
                                    安全扣
                                </td>
                                <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                    衣架
                                </td>*@
                            </tr>

                            @if (Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any() != null && Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any())
                            {


                                foreach (var items in Model.OrderDetailCollection.Where(c => c.OID == item.ID))
                                {
                                    counttotal += (decimal)items.Qty;
                                    number++;
                                    if (items.OID == item.ID)
                                    {
                                        <tr style="height: 30px;">
                                            <td style="text-align: center; font-size: 14px;">@number</td>
                                            <td style="text-align: center; font-size: 14px;">@items.Area</td>
                                            <td style="text-align: center; font-size: 14px;">@items.Location</td>
                                            <td style="text-align: center; font-size: 14px;">@items.SKU</td>
                                            <td style="text-align: center; font-size: 14px;width:300px;">@items.GoodsName</td>
                                            @*<td style="text-align: center; font-size: 14px;">@items.Size</td>
                                            <td style="text-align: center; font-size: 14px;">@items.BU</td>*@
                                            <td style="text-align: center; font-size: 14px;width:70px;">@items.Qty.ToString().Substring(0, @items.Qty.ToString().Length - 3)</td>  @*//使用截取字符串的方法去掉小数点*@
                                            <td style="text-align: center; font-size: 14px;width:70px;">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                            @*<td style="text-align: center; font-size: 14px;">@items.Gender</td>
                                            <td style="text-align: center; font-size: 14px;">@items.Price</td>
                                            <td style="text-align:center;font-size:14px;">@items.MSRP</td>
                                            <td style="text-align: center; font-size: 14px;">@items.SafeLock</td>
                                            <td style="text-align: center; font-size: 14px;">@items.Hanger</td>*@
                                        </tr>
                                    }
                                }
                                <tr>
                                    <td style="border-right:none;border-bottom:none;" colspan="3"> </td>
                                    <td style="text-align: center; font-size: 14px;border-left:none;border-bottom:none;" colspan="2">总计 : @counttotal.ToString().Substring(0, @counttotal.ToString().Length - 3)</td>
                                    <td style="border-bottom:none" colspan="2"> </td>

                                </tr>
                                <tr>
                                    <td style="text-align: left; font-size: 14px;border-right:none;border-top:none;" colspan="3">捡货人：</td>
                                    <td style="text-align: left; font-size: 14px;border-left:none;border-top:none;" colspan="2">捡货时间:</td>
                                    <td style="text-align: right;border-top:none;" colspan="2"> 1 / 1 页</td>

                                </tr>
                            }
                        </table>
                    </div>
                </div>
            }
        }
        else
        {
            CurrentPage++;
            var i = (counts - 25) % 35 == 0 ? (counts - 25) / 35 + 1 : ((counts - 25) / 35) + 2;
            for (var j = 0; j < i; j++)
            {
                int skip = 0; int Take = 25;
                ss = ss + 1;

                if (ss < i)
                {
                    <div class="PageNext" style="width: 99%; height: 100%;">
                        <div style="width: 100%; height: 100%;">
                            @if (ss == 1)
                            {
                                <table style="width: 100%;">
                                    <tr>
                                        <td style="width: 40%; font-weight: bolder; font-size: 30px; vertical-align: bottom; text-align: center;">
                                            <span style="margin-left: 40px;">拣货单</span>
                                        </td>
                                    </tr>
                                </table>

                                <hr size="1" noshadow color="black" style="border: none; border-top: 2px solid #000;" />

                                <table style="width: 100%; text-align: left;">
                                    <tr>
                                        <td colspan="2" style="font-weight: bold; font-size: 16px;">
                                            订单信息
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr style="height: 20px;">
                                        <td style="text-align: left;" colspan="1">
                                            <div class="bcTarget">@item.OrderNumber.ToString()</div>
                                        </td>
                                        <td style="text-align: left;" colspan="2">
                                            <div class="bcTarget">@item.ExternOrderNumber.ToString()</div>
                                        </td>
                                    </tr>
                                    <tr style="height: 20px;">
                                        <td style="font-weight: bold; font-size: 14px;">
                                            出库单号：<strong style="border-bottom: 1px solid #000;">@item.OrderNumber</strong>
                                        </td>

                                        <td style="font-weight: bold; font-size: 14px;">
                                            外部单号：<strong style="border-bottom: 1px solid #000;">@item.ExternOrderNumber</strong>
                                        </td>
                                    </tr>
                                    <tr>

                                        <td style="font-weight: bold; font-size: 14px;">
                                            预出库单号：<strong style="border-bottom: 1px solid #000;">@item.PreOrderNumber</strong>
                                        </td>
                                        <td style="font-weight: bold; font-size: 14px;">
                                            出库日期：<strong style="border-bottom: 1px solid #000;">@item.OrderTime</strong>
                                        </td>

                                    </tr>
                                    <tr>
                                        <td style="font-weight: bold; font-size: 14px;">
                                            客户姓名：<strong style="border-bottom: 1px solid #000;">@item.Consignee</strong>
                                        </td>
                                        <td style="font-weight: bold; font-size: 14px;">
                                            联系方式：<strong style="border-bottom: 1px solid #000;">@item.Contact</strong>
                                        </td>
                                    </tr>
                                    @*<tr>
                                        <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                            补货类型：<strong style="border-bottom: 1px solid #000;">@item.str8</strong>
                                        </td>
                                        <td style="font-weight:bold;font-size:14px;">
                                            PLNO：<strong style="border-bottom:1px solid #000;">@item.str9</strong>
                                        </td>
                                    </tr>*@
                                    <tr>
                                        <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                            收货地址：<strong style="border-bottom: 1px solid #000;">@item.Address</strong>
                                        </td>
                                    </tr>
                                </table>
                            }
                            <table border="1" cellspacing="0" cellpadding="0" style="width: 100%; margin-top: 5px; border-collapse: collapse;">
                                <tr>
                                    <td style="font-weight: bold; font-size: 16px; text-align: left;" colspan="7">
                                        拣货明细&nbsp;&nbsp;@item.ExternOrderNumber
                                    </td>
                                </tr>
                                <tr style="height: 23px;">
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        行号
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        库区
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        库位
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        SKU
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        产品名称
                                    </td>
                                    @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        Size
                                    </td>
                                    <td style="width:15px; font-weight: bold; font-size: 14px; text-align: center;">
                                        BU
                                    </td>*@
                                    <td style="word-break : break-all;width:35px;font-weight: bold; font-size: 14px; text-align: center;">
                                        建议数量
                                    </td>
                                    <td style="white-space: nowrap; width:35px;font-weight: bold; font-size: 14px; text-align: center;">
                                        实捡数量
                                    </td>
                                    @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        Gender
                                    </td>
                                    <td style="word-break : break-all; width:32px;font-weight: bold; font-size: 14px; text-align: center;">
                                        Retail Price
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        MSRP
                                    </td>
                                    <td style="word-break : break-all; width:25px;font-weight: bold; font-size: 14px; text-align: center;">
                                        安全扣
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        衣架
                                    </td>*@
                                </tr>

                                @if (Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any() != null && Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any())
                                {
                                    if (ss > 1)
                                    {
                                        skip = (j - 1) * 40 + 30; Take = 40;
                                    }
                                    foreach (var items in Model.OrderDetailCollection.Where(c => c.OID == item.ID).Skip(skip).Take(Take))
                                    {
                                        counttotal += (decimal)items.Qty;
                                        number++;
                                        if (items.OID == item.ID)
                                        {
                                <tr style="height: 30px;">
                                    <td style="text-align: center; font-size: 14px;">@number</td>
                                    <td style="text-align: center; font-size: 14px;">@items.Area</td>
                                    <td style="text-align: center; font-size: 14px;">@items.Location</td>
                                    <td style="text-align: center; font-size: 14px;">@items.SKU</td>
                                    <td style="text-align: center; font-size: 14px;width:300px;">@items.GoodsName</td>
                                    @*<td style="text-align: center; font-size: 14px;">@items.Size</td>
                                    <td style="text-align: center; font-size: 14px;">@items.BU</td>*@
                                    <td style="text-align: center; font-size: 14px;width:70px;">@items.Qty.ToString().Substring(0, @items.Qty.ToString().Length - 3)</td>
                                    <td style="text-align: center; font-size: 14px;width:70px;">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                    @*<td style="text-align: center; font-size: 14px;">@items.Gender</td>
                                    <td style="text-align: center; font-size: 14px;">@items.Price</td>
                                    <td style="text-align: center; font-size:14px;">@items.MSRP</td>
                                    <td style="text-align: center; font-size: 14px;">@items.SafeLock</td>
                                    <td style="text-align: center; font-size: 14px;">@items.Hanger</td>*@
                                </tr>
                                        }
                                    }
                                <tr style="height: 23px;">
                                    <td style="text-align: left; font-size: 14px;" colspan="3">捡货人：</td>
                                    <td style="text-align: left; font-size: 14px;" colspan="2">捡货时间:</td>
                                    <td style="text-align: right; font-size: 14px;" colspan="2">@ss / @i 页</td>
                                </tr>
                                }
                            </table>
                        </div>
                    </div>
                }
                else
                {
                    <div class="" style="width: 99%; height: 100%;">
                        <div style="width: 100%; height: 100%;">
                            @if (ss == 1)
                            {
                                <table style="width: 100%;">
                                    <tr>
                                        <td style="width: 40%; font-weight: bolder; font-size: 30px; vertical-align: bottom; text-align: center;">
                                            <span style="margin-left: 40px;">拣货单</span>
                                        </td>
                                    </tr>
                                </table>
                                <hr size="1" noshadow color="black" style="border: none; border-top: 2px solid #000;" />

                                <table style="width: 100%; text-align: left;">
                                    <tr>
                                        <td colspan="2" style="font-weight: bold; font-size: 16px;">
                                            订单信息
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr style="height: 20px;">
                                        <td style="text-align: left;" colspan="1">
                                            <div class="bcTarget">@item.OrderNumber.ToString()</div>
                                        </td>
                                        <td style="text-align: left;" colspan="2">
                                            <div class="bcTarget">@item.ExternOrderNumber.ToString()</div>
                                        </td>
                                    </tr>
                                    <tr style="height: 20px;">
                                        <td style="font-weight: bold; font-size: 14px;">
                                            出库单号：<strong style="border-bottom: 1px solid #000;">@item.OrderNumber</strong>
                                        </td>

                                        <td style="font-weight: bold; font-size: 14px;">
                                            外部单号：<strong style="border-bottom: 1px solid #000;">@item.ExternOrderNumber</strong>
                                        </td>
                                    </tr>
                                    <tr>

                                        <td style="font-weight: bold; font-size: 14px;">
                                            预出库单号：<strong style="border-bottom: 1px solid #000;">@item.PreOrderNumber</strong>
                                        </td>
                                        <td style="font-weight: bold; font-size: 14px;">
                                            出库日期：<strong style="border-bottom: 1px solid #000;">@item.OrderTime</strong>
                                        </td>

                                    </tr>
                                    <tr>
                                        <td style="font-weight: bold; font-size: 14px;">
                                            客户姓名：<strong style="border-bottom: 1px solid #000;">@item.Consignee</strong>
                                        </td>
                                        <td style="font-weight: bold; font-size: 14px;">
                                            联系方式：<strong style="border-bottom: 1px solid #000;">@item.Contact</strong>
                                        </td>
                                    </tr>
                                    @*<tr>
                                        <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                            补货类型：<strong style="border-bottom: 1px solid #000;">@item.str8</strong>
                                        </td>
                                        <td style="font-weight:bold;font-size:14px;">
                                            PLNO：<strong style="border-bottom:1px solid #000;">@item.str9</strong>
                                        </td>
                                    </tr>*@
                                    <tr>
                                        <td style="font-weight: bold; font-size: 14px;" colspan="2">
                                            收货地址：<strong style="border-bottom: 1px solid #000;">@item.Address</strong>
                                        </td>
                                    </tr>
                                </table>
                            }
                            <table border="1" cellspacing="0" cellpadding="0" style="width: 100%; margin-top: 5px; border-collapse: collapse;">
                                <tr>
                                    <td style="font-weight: bold; font-size: 16px; text-align: left;" colspan="7">
                                        拣货明细&nbsp;&nbsp;@item.ExternOrderNumber
                                    </td>
                                </tr>    
                                <tr style="height: 23px;">
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                            行号
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                            库区
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                            库位
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                            SKU
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                            产品名称
                                    </td>
                                    @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                            Size
                                    </td>
                                    <td style="width:15px; font-weight: bold; font-size: 14px; text-align: center;">
                                            BU
                                    </td>*@
                                    <td style="word-break : break-all;width:35px;font-weight: bold; font-size: 14px; text-align: center;">
                                            建议数量
                                    </td>
                                    <td style="white-space: nowrap; width:35px; font-weight: bold; font-size: 14px; text-align: center;">
                                            实捡数量
                                    </td>
                                    @*<td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        Gender
                                    </td>
                                    <td style="word-break : break-all; width:32px;font-weight: bold; font-size: 14px; text-align: center;">
                                        Retail Price
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        MSRP
                                    </td>
                                    <td style="word-break : break-all; width:25px;font-weight: bold; font-size: 14px; text-align: center;">
                                        安全扣
                                    </td>
                                    <td style="font-weight: bold; font-size: 14px; text-align: center;">
                                        衣架
                                    </td>*@
                                </tr>

                            @if (Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any() != null && Model.OrderDetailCollection.Where(c => c.OID == item.ID).Any())
                            {
                                    if (ss > 1)
                                    {
                                        skip = (j - 1) * 35 + 25; Take = 35;  //take 是第二页的行数
                                    }
                                    foreach (var items in Model.OrderDetailCollection.Where(c => c.OID == item.ID).Skip(skip).Take(Take))
                                    {
                                        counttotal += (decimal)items.Qty;
                                        number++;
                                        if (items.OID == item.ID)
                                        {
                                <tr style="height: 30px;">
                                    <td style="text-align: center; font-size: 14px;">@number</td>
                                    <td style="text-align: center; font-size: 14px;">@items.Area</td>
                                    <td style="text-align: center; font-size: 14px;">@items.Location</td>
                                    <td style="text-align: center; font-size: 14px;">@items.SKU</td>
                                    <td style="text-align: center; font-size: 14px;width:300px;">@items.GoodsName</td>
                                    @*<td style="text-align: center; font-size: 14px;">@items.Size</td>
                                    <td style="text-align: center; font-size: 14px;">@items.BU</td>*@
                                    <td style="text-align: center; font-size: 14px;width:70px;">@items.Qty.ToString().Substring(0, @items.Qty.ToString().Length - 3)</td>
                                    <td style="text-align: center; font-size: 14px;width:70px;">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                    @*<td style="text-align: center; font-size: 14px;">@items.Gender</td>
                                    <td style="text-align: center; font-size: 14px;">@items.Price</td>
                                    <td style="text-align:center;  font-size: 14px;">@items.MSRP</td>
                                    <td style="text-align: center; font-size: 14px;">@items.SafeLock</td>
                                    <td style="text-align: center; font-size: 14px;">@items.Hanger</td>*@
                                </tr>
                                        }
                                    }
                                    <tr>
                                        <td style="border-right:none;border-bottom:none;" colspan="3"> </td>
                                        <td style="text-align: center; font-size: 14px;border-left:none;border-bottom:none;" colspan="2">总计 : @counttotal.ToString().Substring(0, @counttotal.ToString().Length - 3)</td>
                                        <td style="border-bottom:none" colspan="2"> </td> 
                                    </tr>
                                    <tr>
                                        <td style="text-align: left; font-size: 14px;border-right:none;border-top:none;" colspan="3">捡货人：</td>
                                        <td style="text-align: left; font-size: 14px;border-left:none;border-top:none;" colspan="2">捡货时间:</td>
                                        <td style="text-align: right;border-top:none;" colspan="2">@ss / @i 页</td>
                                    </tr>
                            }
                            </table>
                        </div>
                    </div>
                }
            }
        }
    }
}
<object id="ojatoolsPrinter" codebase="JatoolsPrinter/jatoolsPrinter.cab#version=5,4,0,0" classid="clsid:B43D3361-D075-4BE2-87FE-057188254255" width="0" height="0">
    <embed id="ejatoolsPrinter" type="application/x-vnd.jatoolsPrinter" pluginspage="JatoolsPrinter/setup.exe" width="0" height="0" />
</object>